{"version":3,"file":"index.js","sources":["../src/js/footer.js"],"sourcesContent":["// import { postRequest } from './api';\nimport iziToast from 'izitoast';\n\nasync function postRequest(options) {\n  try {\n    const response = await fetch(\n      'https://portfolio-js.b.goit.study/api/requests',\n      options\n    );\n    if (!response.ok) {\n      throw new Error('Not found');\n    }\n    return response.json();\n  } catch (error) {\n    throw error;\n  }\n}\n\nconst form = document.querySelector('.footer-form-order');\n// const modalWindow = document.querySelector('.modal-window');\nconst emailInput = document.querySelector('.email');\nconst message = document.querySelector('.message');\n// ================================================\nemailInput.addEventListener('change', function () {\n  validate(emailInput);\n});\nfunction validateEmail(input) {\n  // Проста перевірка за допомогою регулярного виразу\n  const emailRegex =\n    /[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/;\n  return emailRegex.test(input.toLowerCase());\n}\nfunction validate(input) {\n  // Видалення попередніх помилок\n  removeMessage(input);\n  // Перевірка введеної електронної пошти\n  const email = input.value;\n  const isValid = validateEmail(email);\n  const labelError = document.querySelector('label');\n  // Встановлення класу та тексту повідомлення в залежності від результату валідації\n  if (isValid) {\n    input.classList.remove('error-label');\n    input.classList.add('success-label');\n    addMessage(input, 'Success!', 'success');\n    if (labelError) {\n      labelError.classList.remove('error-label');\n      labelError.classList.add('success-label');\n    }\n  } else {\n    input.classList.remove('success-label');\n    input.classList.add('error-label');\n    addMessage(input, 'Invalid email, try again', 'error');\n    if (labelError) {\n      labelError.classList.remove('success-label');\n      labelError.classList.add('error-label');\n    }\n  }\n}\n// Створення нового елемента для відображення повідомлення\nconst messageElement = document.createElement('label');\nfunction addMessage(input, text, format) {\n  // Встановлення тексту повідомлення\n  messageElement.textContent = text;\n  // Встановлення класу залежно від формату\n  messageElement.classList.add(format + '-label');\n  // Додавання створеного елемента під інпут в батьківський елемент input\n  input.parentNode.children[0].after(messageElement);\n}\nfunction removeMessage(input) {\n  // Видалення класів 'error-label' і 'success-label' в батьківському елементі input\n  const successLabel = document.querySelector('label.success-label');\n  const errorLabel = document.querySelector('label.error-label');\n  if (successLabel) {\n    successLabel.innerHTML = '';\n  }\n  if (errorLabel) {\n    errorLabel.innerHTML = '';\n  }\n  input.classList.remove('error-label');\n  input.classList.remove('success-label');\n}\n// ==================================\nmessage.addEventListener('change', changeAndSaveComment);\nfunction changeAndSaveComment() {\n  const messageFull = message.value;\n  message.value = changeComment(message, 20);\n}\n// функція змінення довжини коментаря\nfunction changeComment(text, maxLength) {\n  const change = text.value;\n  if (change.length <= maxLength) {\n    return change;\n  } else {\n    return change.slice(0, maxLength) + '...';\n  }\n}\nfunction answerError() {\n  iziToast.show({\n    color: 'red',\n    message: `ERROR SERVER`,\n    position: 'topCenter',\n  });\n  // return error;\n}\n// =========================================================\nform.addEventListener('submit', handleSubmit);\nfunction handleSubmit(event) {\n  event.preventDefault();\n  const elements = event.currentTarget.elements;\n  const email = elements.email.value;\n  const comments = elements.comments.value;\n  let validEmail = validateEmail(email);\n  const comit = {\n    email: email.trim(),\n    comment: comments.trim(),\n  };\n  const options = {\n    method: 'POST',\n    body: JSON.stringify(comit),\n    headers: {\n      'Content-Type': 'application/json; charset=UTF-8',\n    },\n  };\n  try {\n    if (validEmail === true && comments != '') {\n      //=========================симуляція помилки від сервера\n      //  throw postRequest(options)\n      // ===============================\n      postRequest(options);\n      //  console.log(postRequest(options));\n      addClassIsOpenModal();\n      event.currentTarget.reset();\n    } else {\n      iziToast.show({\n        color: 'red',\n        message: `All form fields must be filled in`,\n        position: 'topCenter',\n      });\n    }\n  } catch (error) {\n    answerError();\n  }\n  removeMessage(emailInput);\n}\n\nconst modalWindow = document.querySelector('.modal-window');\nconst modalWindowClose = document.querySelector('.modal-close');\n\nexport function addClassIsOpenModal() {\n  return modalWindow.classList.add('is-open');\n}\nfunction deleteClassIsOpenModal() {\n  return modalWindow.classList.remove('is-open');\n}\n// const isOpenModalWindow = formFooterButton.addEventListener(\"click\", addClassIsOpenModal); //open modal on submit form\nconst modalCloseButton = modalWindowClose.addEventListener(\n  'click',\n  deleteClassIsOpenModal\n); // close moda on click x\n\n//close modal keydown esc\nconst modalWindowCloseEsc = document.addEventListener('keydown', event => {\n  if (event.key === 'Escape') {\n    return modalWindow.classList.remove('is-open');\n  }\n});\n\n// close modal click backdrop\nconst modalWindowCloseBackDrop = modalWindow.addEventListener(\n  'click',\n  event => {\n    const clickedElement = event.target;\n    if (clickedElement !== modalWindow) {\n      return;\n    }\n    return modalWindow.classList.remove('is-open');\n  }\n);\n"],"names":["postRequest","options","response","error","form","emailInput","message","validate","validateEmail","input","removeMessage","email","isValid","labelError","addMessage","messageElement","text","format","successLabel","errorLabel","changeAndSaveComment","changeComment","maxLength","change","answerError","iziToast","handleSubmit","event","elements","comments","validEmail","comit","addClassIsOpenModal","modalWindow","modalWindowClose","deleteClassIsOpenModal"],"mappings":"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"}